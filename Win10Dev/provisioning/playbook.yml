---
- hosts: all
  tasks:
  
  # Setup SSH with script that came with the box
  - name: Setup SSH
    win_shell: C:\BGinfo\openssh.ps1

  # Copy BGI config files over to the box
  - name: Setup BGI config
    win_copy: 
      src: "{{ item.src }}"  
      dest: "{{ item.dest }}"
      remote_src: yes
    with_items:
      - { src: C:\vagrant\files\modern.IE.1024x768.jpg, dest: C:\BGinfo\modern.IE.1024x768.jpg }
      - { src: C:\vagrant\files\BGCONFIG.BGI, dest: C:\BGinfo\BGCONFIG.BGI }



  # Copy BGI config files over to the box
  #- name: Setup BGI wallpaper
  #  win_copy: 
  #    src: C:\vagrant\files\modern.IE.1024x768.jpg  
  #    dest: C:\BGinfo\modern.IE.1024x768.jpg
  #    remote_src: yes
  
  # Install chocolatey
  - name: Install chocolatey
    ansible.builtin.win_chocolatey:
        name:
        - chocolatey-core.extension
        - chocolatey-windowsupdate.extension
        state: present

  # Install packages
  - name: Install tools
    win_chocolatey:
        name:
        - reshack
        - pebear
        - x64dbg.portable
        - pestudio
        state: present

  # make this a handler and and add notify to install tools -> test this
  - name: Create shortcuts
    win_shell: C:\vagrant\create_choco_shortcut.ps1 PE-bear x96dbg pestudio

  - name: install firefox
    win_chocolatey:
        name:
        - firefox
        state: present
  
  - name: install golang
    win_chocolatey:
        name:
        - golang
        state: present
  
  - name: install vscode
    win_chocolatey:
        name:
        - vscode
        state: present
          
  # depends on Win updates, so might require a reboot or another
  - name: install Visual Studio 2019 community 
    win_chocolatey:
        name:
        - visualstudio2019community  
        state: present

  - name: install Visual Studio 2019 build tools 
    win_chocolatey:
        name:  
        - visualstudio2019buildtools
        state: present

  - name: install dnspy
    win_chocolatey:
      name:
      - dnspy
      state: present
  #- name: Install dnSpy
  #  win_chocolatey:
  #      name:
  #      - dnspy
  #      state: present